<!-- Modern Profile Component -->
<div class="px-8 py-6 bg-background-light font-heading">
  <!-- Header Section with Tabs -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
    <div class="mb-4 md:mb-0">
      <h1 class="text-2xl font-bold text-primary-700">Meu Perfil</h1>
      <p class="text-neutral-600 mt-1">Gerencie suas informações pessoais e preferências</p>
    </div>

    <!-- Tab Navigation -->
    <div class="flex bg-white rounded-lg shadow-sm border border-neutral-200">
      <button
        (click)="setActiveTab('profile')"
        [ngClass]="{'bg-primary-50 text-primary-700 border-b-2 border-primary-500': activeTab === 'profile', 'text-neutral-600 hover:bg-neutral-50': activeTab !== 'profile'}"
        class="px-4 py-2 font-medium text-sm transition-all"
      >
        <i class="pi pi-user mr-2"></i>
        Perfil
      </button>
      <button
        (click)="setActiveTab('account')"
        [ngClass]="{'bg-primary-50 text-primary-700 border-b-2 border-primary-500': activeTab === 'account', 'text-neutral-600 hover:bg-neutral-50': activeTab !== 'account'}"
        class="px-4 py-2 font-medium text-sm transition-all"
      >
        <i class="pi pi-cog mr-2"></i>
        Conta
      </button>
      <button
        (click)="setActiveTab('notifications')"
        [ngClass]="{'bg-primary-50 text-primary-700 border-b-2 border-primary-500': activeTab === 'notifications', 'text-neutral-600 hover:bg-neutral-50': activeTab !== 'notifications'}"
        class="px-4 py-2 font-medium text-sm transition-all"
      >
        <i class="pi pi-bell mr-2"></i>
        Notificações
      </button>
    </div>
  </div>

  <!-- Profile Tab Content -->
  <div *ngIf="activeTab === 'profile'" class="grid grid-cols-1 lg:grid-cols-12 gap-8">
    <!-- Profile Card -->
    <div class="lg:col-span-4">
      <div class="bg-white rounded-xl shadow-md overflow-hidden">
        <!-- Cover Image with Gradient Overlay -->
        <div class="relative h-32 bg-gradient-to-r from-primary-600 to-primary-500">
          <div class="absolute inset-0 bg-[url('/bg_st.png')] bg-cover bg-center opacity-20"></div>

          <!-- Edit Cover Button -->
          <button
            (click)="uploadCoverImage()"
            class="absolute top-3 right-3 bg-white bg-opacity-20 backdrop-blur-sm px-2 py-1 rounded-full text-xs font-medium text-white hover:bg-opacity-30 transition-all flex items-center"
          >
            <i class="pi pi-camera mr-1"></i>
            Editar
          </button>
        </div>

        <!-- Profile Image -->
        <div class="relative flex justify-center">
          <div class="absolute -top-12">
            <div class="relative">
              <div
                class="w-24 h-24 rounded-full bg-gradient-to-r from-primary-500 to-primary-600 flex items-center justify-center p-1">
                <img
                  src="/users/4.png"
                  alt="Profile"
                  class="w-full h-full rounded-full object-cover border-2 border-white"
                />
              </div>
              <!-- Edit Profile Image Button -->
              <button
                (click)="uploadProfileImage()"
                class="absolute bottom-0 right-0 w-8 h-8 rounded-full bg-white shadow-md flex items-center justify-center border border-neutral-200 text-primary-600 hover:bg-primary-50 transition-all"
              >
                <i class="pi pi-camera"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Profile Info -->
        <div class="pt-16 px-6 pb-6 text-center">
          <div class="flex items-center justify-center gap-2 mb-2">
            <h2 class="text-xl font-bold text-neutral-800">{{ (user$ | async)?.phone }}</h2>
            <!-- VIP Badge -->
            <span 
              *ngIf="(student$ | async)?.vip"
              class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gradient-to-r from-yellow-400 to-yellow-500 text-white"
              title="VIP Student"
            >
              <i class="pi pi-star-fill text-[10px]"></i>
            </span>
          </div>
          <div class="flex justify-center items-center gap-2 mt-2 flex-wrap">
            <div class="bg-primary-50 text-primary-700 px-3 py-1 rounded-full text-sm font-medium flex items-center">
              <span class="w-2 h-2 bg-primary-500 rounded-full mr-2"></span>
              {{ (student$ | async)?.level?.name }}
            </div>
            <div 
              *ngIf="(student$ | async)?.vip && (student$ | async)?.directChatEnabled"
              class="bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium flex items-center border border-yellow-200"
            >
              <i class="pi pi-comments text-xs mr-1"></i>
              Chat VIP Ativo
            </div>
          </div>

          <!-- Contact Info -->
          <div class="mt-6 space-y-3">
            <div class="flex items-center text-neutral-600">
              <i class="pi pi-envelope w-6 text-primary-500"></i>
              <span class="ml-2">{{ (user$ | async)?.email }}</span>
            </div>
            <div class="flex items-center text-neutral-600">
              <i class="pi pi-phone w-6 text-primary-500"></i>
              <span class="ml-2">{{ (user$ | async)?.phone }}</span>
            </div>
            <div class="flex items-center text-neutral-600">
              <i class="pi pi-map-marker w-6 text-primary-500"></i>
              <span class="ml-2">{{ (student$ | async)?.center?.name }}</span>
            </div>
          </div>

          <!-- Bio -->
          <div class="mt-6 pt-6 border-t border-neutral-100">
            <h3 class="text-sm font-medium text-neutral-500 mb-2">SOBRE MIM</h3>
            <p class="text-neutral-600 text-sm">{{ (student$ | async)?.notes }}</p>
          </div>
        </div>
      </div>
    </div>


    <!-- Edit Profile Form -->
    <ng-form [formGroup]="userProfileForm" class="lg:col-span-8">
      <!-- Loading State -->
      <div *ngIf="isLoading$ | async" class="bg-white rounded-xl shadow-md p-6 text-center">
        <div class="animate-pulse flex flex-col items-center">
          <div class="rounded-full bg-neutral-200 h-12 w-12 mb-4"></div>
          <div class="h-4 bg-neutral-200 rounded w-1/2 mb-2"></div>
          <div class="h-4 bg-neutral-200 rounded w-1/3"></div>
        </div>
        <p class="text-neutral-600 mt-4">Carregando perfil...</p>
      </div>

      <div *ngIf="!(isLoading$ | async) && !(errors$ | async)" class="bg-white rounded-xl shadow-md overflow-hidden">
        <!-- Form Header -->
        <div class="relative bg-gradient-to-r from-primary-600 to-primary-500 px-6 py-4 text-white">
          <div class="absolute inset-0 bg-[url('/bg_st.png')] bg-cover bg-center opacity-20"></div>
          <div class="flex items-center relative">
            <div class="p-3 bg-white bg-opacity-20 rounded-lg mr-4">
              <i class="pi pi-user-edit text-2xl"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold">Editar Perfil</h2>
              <p class="text-sm opacity-90 mt-1">Atualize suas informações pessoais</p>
            </div>
          </div>
        </div>

        <!-- Form Content -->
        <div class="p-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- First Name -->
            <div>
              <label for="firstName" class="block text-sm font-medium text-neutral-700 mb-1">Nome</label>
              <input
                id="firstName"
                type="text"
                formControlName="firstName"
                class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all"
              />
            </div>

            <!-- Last Name -->
            <div>
              <label for="lastName" class="block text-sm font-medium text-neutral-700 mb-1">Sobrenome</label>
              <input
                id="lastName"
                type="text"
                formControlName="lastName"
                class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all"
              />
            </div>

            <!-- Email -->
            <div>
              <label for="email" class="block text-sm font-medium text-neutral-700 mb-1">E-mail</label>
              <input
                id="email"
                type="email"
                formControlName="email"
                class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all"
              />
            </div>

            <!-- Phone -->
            <div>
              <label for="phone" class="block text-sm font-medium text-neutral-700 mb-1">Telefone</label>
              <input
                id="phone"
                type="tel"
                formControlName="phone"
                class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all"
                placeholder="+55 (00) 00000-0000"
              />
            </div>

            <!-- Location -->
            <div>
              <label for="center" class="block text-sm font-medium text-neutral-700 mb-1">Centro</label>
              <input
                id="center"
                type="text"
                formControlName="location"
                class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all"
                placeholder="{{(student$ | async)?.center?.name}}"
              />
            </div>

            <!-- Country -->
            <div>
              <label for="country" class="block text-sm font-medium text-neutral-700 mb-1">Género</label>
              <input
                id="gender"
                type="text"
                formControlName="gender"
                class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all"
              />
            </div>
          </div>

          <!-- Bio Textarea -->
          <div class="mt-6">
            <label for="bio" class="block text-sm font-medium text-neutral-700 mb-1">Sobre mim</label>
            <textarea
              id="bio"
              formControlName="bio"
              rows="4"
              class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all"
              placeholder="{{(student$ | async)?.notes}}"
            ></textarea>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="px-6 py-4 bg-neutral-50 border-t border-neutral-200 flex justify-end space-x-4">
          <button
            (click)="discardChanges()"
            class="px-4 py-2 bg-white border border-neutral-300 rounded-lg text-neutral-700 hover:bg-neutral-100 transition-all flex items-center"
          >
            <i class="pi pi-times mr-2"></i>
            Descartar
          </button>
          <button
            (click)="saveChanges()"
            class="px-4 py-2 bg-gradient-to-r from-primary-600 to-primary-500 rounded-lg text-white hover:from-primary-700 hover:to-primary-600 transition-all flex items-center shadow-sm"
          >
            <i class="pi pi-check mr-2"></i>
            Salvar alterações
          </button>
        </div>
      </div>
    </ng-form>
  </div>

  <!-- Account Tab Content -->
  <div *ngIf="activeTab === 'account'" class="grid grid-cols-1 lg:grid-cols-12 gap-8">
    <!-- Account Security Card -->
    <div class="lg:col-span-6">
      <div class="bg-white rounded-xl shadow-md overflow-hidden">
        <!-- Card Header -->
        <div class="relative bg-gradient-to-r from-accent-600 to-accent-500 px-6 py-4 text-white">
          <div class="absolute inset-0 bg-[url('/bg_st.png')] bg-cover bg-center opacity-20"></div>
          <div class="flex items-center relative">
            <div class="p-3 bg-white bg-opacity-20 rounded-lg mr-4">
              <i class="pi pi-lock text-2xl"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold">Segurança da Conta</h2>
              <p class="text-sm opacity-90 mt-1">Gerencie sua senha e segurança</p>
            </div>
          </div>
        </div>

        <!-- Card Content -->
        <div class="p-6">
          <div class="space-y-6">
            <!-- Change Password -->
            <div>
              <h3 class="text-lg font-medium text-neutral-800 mb-4">Alterar Senha</h3>

              <div class="space-y-4">
                <div>
                  <label for="currentPassword" class="block text-sm font-medium text-neutral-700 mb-1">Senha
                    atual</label>
                  <input
                    id="currentPassword"
                    type="password"
                    class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500 transition-all"
                    placeholder="Digite sua senha atual"
                  />
                </div>

                <div>
                  <label for="newPassword" class="block text-sm font-medium text-neutral-700 mb-1">Nova senha</label>
                  <input
                    id="newPassword"
                    type="password"
                    class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500 transition-all"
                    placeholder="Digite sua nova senha"
                  />
                </div>

                <div>
                  <label for="confirmPassword" class="block text-sm font-medium text-neutral-700 mb-1">Confirmar nova
                    senha</label>
                  <input
                    id="confirmPassword"
                    type="password"
                    class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500 transition-all"
                    placeholder="Confirme sua nova senha"
                  />
                </div>
              </div>

              <button
                class="mt-4 px-4 py-2 bg-gradient-to-r from-accent-600 to-accent-500 rounded-lg text-white hover:from-accent-700 hover:to-accent-600 transition-all flex items-center shadow-sm">
                <i class="pi pi-lock mr-2"></i>
                Alterar senha
              </button>
            </div>

            <!-- Two-Factor Authentication -->
            <div class="pt-6 border-t border-neutral-200">
              <div class="flex justify-between items-center">
                <div>
                  <h3 class="text-lg font-medium text-neutral-800">Autenticação de dois fatores</h3>
                  <p class="text-sm text-neutral-600 mt-1">Adicione uma camada extra de segurança à sua conta</p>
                </div>
                <div class="relative inline-block w-12 h-6 rounded-full bg-neutral-200">
                  <div class="absolute left-1 top-1 w-4 h-4 rounded-full bg-white transition-all"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Language and Region Card -->
    <div class="lg:col-span-6">
      <div class="bg-white rounded-xl shadow-md overflow-hidden">
        <!-- Card Header -->
        <div class="relative bg-gradient-to-r from-secondary-600 to-secondary-500 px-6 py-4 text-white">
          <div class="absolute inset-0 bg-[url('/bg_st.png')] bg-cover bg-center opacity-20"></div>
          <div class="flex items-center relative">
            <div class="p-3 bg-white bg-opacity-20 rounded-lg mr-4">
              <i class="pi pi-globe text-2xl"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold">Idioma e Região</h2>
              <p class="text-sm opacity-90 mt-1">Personalize suas preferências regionais</p>
            </div>
          </div>
        </div>

        <!-- Card Content -->
        <div class="p-6">
          <div class="space-y-6">
            <!-- Language Selection -->
            <div>
              <label for="language" class="block text-lg font-medium text-neutral-800 mb-4">Idioma da plataforma</label>
              <div class="relative">
                <select
                  id="language"
                  [(ngModel)]="settings.language"
                  class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-secondary-500 focus:border-secondary-500 transition-all appearance-none"
                >
                  <option value="pt-BR">Português (Brasil)</option>
                  <option value="en-US">English (United States)</option>
                  <option value="es-ES">Español</option>
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                  <i class="pi pi-chevron-down text-neutral-400"></i>
                </div>
              </div>
            </div>

            <!-- Time Zone -->
            <div class="pt-6 border-t border-neutral-200">
              <label for="timezone" class="block text-lg font-medium text-neutral-800 mb-4">Fuso horário</label>
              <div class="relative">
                <select
                  id="timezone"
                  class="w-full px-4 py-2 bg-white border border-neutral-200 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-secondary-500 focus:border-secondary-500 transition-all appearance-none"
                >
                  <option value="America/Sao_Paulo">America/São Paulo (GMT-3)</option>
                  <option value="America/New_York">America/New York (GMT-5)</option>
                  <option value="Europe/London">Europe/London (GMT+0)</option>
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                  <i class="pi pi-chevron-down text-neutral-400"></i>
                </div>
              </div>
            </div>

            <!-- Date Format -->
            <div class="pt-6 border-t border-neutral-200">
              <label for="dateFormat" class="block text-lg font-medium text-neutral-800 mb-4">Formato de data</label>
              <div class="grid grid-cols-2 gap-4">
                <div class="flex items-center">
                  <input type="radio" id="dateFormat1" name="dateFormat" class="mr-2" checked>
                  <label for="dateFormat1">DD/MM/AAAA</label>
                </div>
                <div class="flex items-center">
                  <input type="radio" id="dateFormat2" name="dateFormat" class="mr-2">
                  <label for="dateFormat2">MM/DD/AAAA</label>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Notifications Tab Content -->
  <div *ngIf="activeTab === 'notifications'" class="grid grid-cols-1 gap-8">
    <div class="bg-white rounded-xl shadow-md overflow-hidden">
      <!-- Card Header -->
      <div class="relative bg-gradient-to-r from-primary-600 to-primary-500 px-6 py-4 text-white">
        <div class="absolute inset-0 bg-[url('/bg_st.png')] bg-cover bg-center opacity-20"></div>
        <div class="flex items-center relative">
          <div class="p-3 bg-white bg-opacity-20 rounded-lg mr-4">
            <i class="pi pi-bell text-2xl"></i>
          </div>
          <div>
            <h2 class="text-xl font-bold">Preferências de Notificação</h2>
            <p class="text-sm opacity-90 mt-1">Gerencie como você recebe notificações</p>
          </div>
        </div>
      </div>

      <!-- Card Content -->
      <div class="p-6">
        <div class="space-y-6">
          <!-- Email Notifications -->
          <div class="flex justify-between items-center pb-6 border-b border-neutral-200">
            <div>
              <h3 class="text-lg font-medium text-neutral-800">Notificações por e-mail</h3>
              <p class="text-sm text-neutral-600 mt-1">Receba atualizações sobre aulas, eventos e materiais por
                e-mail</p>
            </div>
            <div class="relative inline-block w-12 h-6 rounded-full bg-neutral-200"
                 [ngClass]="{'bg-success-500': settings.emailNotifications, 'bg-neutral-200': !settings.emailNotifications}">
              <div class="absolute w-4 h-4 rounded-full bg-white transition-all"
                   [ngClass]="{'left-7 top-1': settings.emailNotifications, 'left-1 top-1': !settings.emailNotifications}"
                   (click)="updateSetting('emailNotifications', !settings.emailNotifications)"></div>
            </div>
          </div>

          <!-- SMS Notifications -->
          <div class="flex justify-between items-center pb-6 border-b border-neutral-200">
            <div>
              <h3 class="text-lg font-medium text-neutral-800">Notificações por SMS</h3>
              <p class="text-sm text-neutral-600 mt-1">Receba lembretes sobre aulas e eventos por SMS</p>
            </div>
            <div class="relative inline-block w-12 h-6 rounded-full bg-neutral-200"
                 [ngClass]="{'bg-success-500': settings.smsNotifications, 'bg-neutral-200': !settings.smsNotifications}">
              <div class="absolute w-4 h-4 rounded-full bg-white transition-all"
                   [ngClass]="{'left-7 top-1': settings.smsNotifications, 'left-1 top-1': !settings.smsNotifications}"
                   (click)="updateSetting('smsNotifications', !settings.smsNotifications)"></div>
            </div>
          </div>

          <!-- Dark Mode -->
          <div class="flex justify-between items-center pb-6 border-b border-neutral-200">
            <div>
              <h3 class="text-lg font-medium text-neutral-800">Modo escuro</h3>
              <p class="text-sm text-neutral-600 mt-1">Ative o modo escuro para reduzir o cansaço visual</p>
            </div>
            <div class="relative inline-block w-12 h-6 rounded-full bg-neutral-200"
                 [ngClass]="{'bg-success-500': settings.darkMode, 'bg-neutral-200': !settings.darkMode}">
              <div class="absolute w-4 h-4 rounded-full bg-white transition-all"
                   [ngClass]="{'left-7 top-1': settings.darkMode, 'left-1 top-1': !settings.darkMode}"
                   (click)="updateSetting('darkMode', !settings.darkMode)"></div>
            </div>
          </div>

          <!-- Marketing Preferences -->
          <div class="pt-4">
            <h3 class="text-lg font-medium text-neutral-800 mb-4">Preferências de marketing</h3>
            <div class="space-y-3">
              <div class="flex items-start">
                <input type="checkbox" id="marketingEmail" class="mt-1 mr-3">
                <div>
                  <label for="marketingEmail" class="font-medium text-neutral-800">E-mails de marketing</label>
                  <p class="text-sm text-neutral-600">Receba informações sobre novos cursos, promoções e eventos</p>
                </div>
              </div>
              <div class="flex items-start">
                <input type="checkbox" id="marketingSMS" class="mt-1 mr-3">
                <div>
                  <label for="marketingSMS" class="font-medium text-neutral-800">SMS de marketing</label>
                  <p class="text-sm text-neutral-600">Receba informações sobre novos cursos, promoções e eventos por
                    SMS</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer with Save Button -->
      <div class="px-6 py-4 bg-neutral-50 border-t border-neutral-200 flex justify-end">
        <button
          class="px-4 py-2 bg-gradient-to-r from-primary-600 to-primary-500 rounded-lg text-white hover:from-primary-700 hover:to-primary-600 transition-all flex items-center shadow-sm">
          <i class="pi pi-save mr-2"></i>
          Salvar preferências
        </button>
      </div>
    </div>
  </div>

  <!-- Footer with Links -->
  <div
    class="mt-8 pt-6 border-t border-neutral-200 flex flex-col md:flex-row justify-between items-center text-sm text-neutral-500">
    <div class="mb-4 md:mb-0">
      <span>© 2024 ST Andrews English School. Todos os direitos reservados.</span>
    </div>
    <div class="flex space-x-6">
      <a href="#" class="hover:text-primary-600 transition-all">Termos de uso</a>
      <a href="#" class="hover:text-primary-600 transition-all">Política de privacidade</a>
      <a href="#" class="hover:text-primary-600 transition-all">Ajuda</a>
    </div>
  </div>
</div>
