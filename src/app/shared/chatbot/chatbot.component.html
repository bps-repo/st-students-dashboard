<!-- Floating chat button -->
<button
  class="chatbot-toggle"
  (click)="toggleChat()"
  [ngClass]="{'open': this.isOpen()}">
  <span class="material-icons">{{ isOpen() ? 'close' : 'chat' }}</span>
</button>

<!-- Chat container -->
<div class="chatbot-container" [ngClass]="{ 'open': isOpen() }">
  <div class="chatbot-header">
    <div class="chatbot-title">
      <span class="material-icons">support_agent</span>
      <h3>Virtual Assistant</h3>
    </div>
    <button class="close-button" (click)="toggleChat()">
      <span class="material-icons">close</span>
    </button>
  </div>

  <!-- Updated message template -->
  <div class="chatbot-messages" #messagesContainer>
    <div *ngFor="let message of messages" class="message"
         [class.user-message]="message.isUser"
         [class.bot-message]="!message.isUser">

      <!-- Message content -->
      <div class="message-content">
        <markdown [data]="message.text"></markdown>
        <span class="message-time">{{ message.timestamp | date:'shortTime' }}</span>
      </div>

      <!-- Message icon -->
      <div class="message-icon"
           [class.user-icon]="message.isUser"
           [class.bot-icon]="!message.isUser">
      <span class="material-icons">
        {{ message.isUser ? 'person' : 'support_agent' }}
      </span>
      </div>
    </div>

    <!-- Typing indicator -->
    <div *ngIf="isTyping" class="message bot-message">
      <div class="message-content typing-indicator">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div class="message-icon bot-icon">
        <span class="material-icons">support_agent</span>
      </div>
    </div>
  </div>

  <div class="chatbot-input">
    <input
      type="text"
      placeholder="Type your message..."
      [(ngModel)]="userMessage"
      (keyup.enter)="sendMessage()">
    <button (click)="sendMessage()">
      <span class="material-icons">send</span>
    </button>
  </div>
</div>
